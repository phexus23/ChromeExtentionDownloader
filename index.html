<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>CRX Download URL Generator</title>
</head>
<body>
  <h1>CRX Direct Link Generator</h1>
  <form id="form">
    Extension ID: <input id="xid" pattern="[a-p]{32}" required><br>
    Chrome Version: <input id="prodversion" value="119.0.0.0" required><br>
    OS: 
    <select id="os">
      <option value="win">Windows</option>
      <option value="mac">Mac</option>
      <option value="linux">Linux</option>
      <option value="cros">ChromeOS</option>
    </select><br>
    Architecture: 
    <select id="arch">
      <option value="x86-64">x86-64</option>
      <option value="arm">ARM</option>
    </select><br>
    <button type="submit">Generate URL</button>
  </form>
  <div id="result"></div>
  <script>
    function getCwsOption(key) {
      return {
        os: document.getElementById("os").value,
        arch: document.getElementById("arch").value,
        os_arch: document.getElementById("arch").value, 
        nacl_arch: document.getElementById("arch").value,
        prodversion: document.getElementById("prodversion").value,
        xid: document.getElementById("xid").value
      }[key];
    }
    document.getElementById('form').onsubmit = e => {
      e.preventDefault();

      var url = 'https://clients2.google.com/service/update2/crx?response=redirect';
      url += '&os=' + getCwsOption('os');
      url += '&arch=' + getCwsOption('arch');
      url += '&os_arch=' + getCwsOption('arch');
      url += '&nacl_arch=' + getCwsOption('nacl_arch');
      url += '&prod=chromiumcrx';
      url += '&prodchannel=unknown';
      url += '&prodversion=' + getCwsOption('prodversion');
      url += '&acceptformat=crx2,crx3';
      url += '&x=id%3D' + getCwsOption('xid');
      url += '%26uc';

      document.getElementById("result").innerHTML = `
        <p>CRX Download URL:</p>
        <a href="${url}" target="_blank">${url}</a>
        <br><br>
        <small>This link may not work directly in Chrome due to security restrictions. Try with curl, wget, or a third-party downloader.</small>`;
    };
  </script>
</body>
</html>
